<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>HttpRequest progress</title>
    <script type="text/javascript" src="gears_init.js"></script>
    <script type="text/javascript" language="javascript">

function handleUploadProgress(event) {
  document.getElementById("uploadProgress").innerHTML =
      document.getElementById("uploadProgress").innerHTML +
      event.loaded + ' of ' + event.total + ' bytes uploaded.<br>\n';
}

function handleDownloadProgress(event) {
  document.getElementById("downloadProgress").innerHTML =
      document.getElementById("downloadProgress").innerHTML +
      event.loaded + ' of ' + event.total + ' bytes downloaded.<br>\n';
}

function testUploadProgress() {
  document.getElementById("uploadProgress").innerHTML =
    "0 of 0 bytes uploaded.<br>\n";

  var data = 'hello';
  do {
    data = data + data;
  } while (data.length < 30000000);

  var request = google.gears.factory.create('beta.httprequest');
  request.upload.onprogress = handleUploadProgress;
  request.open('POST', 'testcases/cgi/send_response_of_size.py?size=5');
  request.send(data);
}

function testDownloadProgress() {
  document.getElementById("downloadProgress").innerHTML =
    "0 of 0 bytes downloaded.<br>\n";

  var request = google.gears.factory.create('beta.httprequest');
  request.onprogress = handleDownloadProgress;
  request.open('GET', 'testcases/cgi/send_response_of_size.py?size=30000000');
  request.send();
}
    </script>
  </head>
  <body>
    <h1>HttpRequest upload progress</h1>
    <form action="">
      <input type="button" value="RunUploadProgressTest"
      onclick="testUploadProgress()">
    </form>
    <div id="uploadProgress">Ready.<br></div>

    <h1>HttpRequest download progress</h1>
    <form action="">
      <input type="button" value="RunDownloadProgressTest"
      onclick="testDownloadProgress()">
    </form>
    <div id="downloadProgress">Ready.<br></div>
  </body>
</html>
